{% extends "base.html" %}

{% block content %}
<div class="quiz-container">
  <!-- Pergunta -->
  <div class="quiz-question">
    <h2>{{ question.text }}</h2>
  </div>

  <!-- Opções -->
  <div class="quiz-options">
    {% for option_text, option_id in [
        (question.option1, 1),
        (question.option2, 2),
        (question.option3, 3),
        (question.option4, 4)
    ] %}
      <button class="option-btn" onclick="submitAnswer('{{ option_id }}')">
        {{ option_text }}
      </button>
    {% endfor %}
  </div>

  <!-- Feedback -->
  <div id="feedback" class="feedback"></div>
</div>

<script>
function submitAnswer(optionId) {
    fetch('{{ url_for("quiz_answer", question_id=question.id) }}', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ selected_option: optionId })
    })
    .then(response => response.json())
    .then(data => {
        const feedbackDiv = document.getElementById('feedback');

        if(data.correct) {
            feedbackDiv.textContent = '✅ Correto!';
            feedbackDiv.style.color = 'green';
        } else {
            feedbackDiv.textContent = '❌ Errado! A resposta correta é: ' + data.correct_answer;
            feedbackDiv.style.color = 'red';
        }

        // Aguarda 1.5s antes de ir para a próxima pergunta
        setTimeout(() => {
            if (data.next_question_url) {
                window.location.href = data.next_question_url;
            } else {
                // Se não houver próxima pergunta, vai para a página de resultado
                window.location.href = '{{ url_for("quiz_result") }}';
            }
        }, 1500);
    })
    .catch(error => console.error('Erro:', error));
}
</script>

<style>
.quiz-container {
    text-align: center;
    margin-top: 50px;
}

.quiz-question h2 {
    font-size: 24px;
    margin-bottom: 30px;
}

.option-btn {
    display: block;
    width: 60%;
    margin: 10px auto;
    padding: 15px;
    font-size: 18px;
    border-radius: 12px;
    border: none;
    background-color: #3b82f6;
    color: white;
    font-weight: 600;
    cursor: pointer;
    transition: transform 0.2s ease, background-color 0.2s ease;
}

.option-btn:hover {
    transform: scale(1.05);
    background-color: #2563eb;
}

.feedback {
    margin-top: 20px;
    font-size: 20px;
    font-weight: bold;
}
</style>
{% endblock %}
